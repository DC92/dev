<?php
$css = $js = "/** OPENLAYERS ADAPTATION
 * Â© Dominique Cavailhez 2017
 * https://github.com/Dominique92/MyOl
 * Based on https://openlayers.org
 *
 * This file is generated by build.php from the src/... sources
 * Please dont modify it. Modify src/... & rebuild it !
 */".PHP_EOL .PHP_EOL;
if (!$_GET)
	echo "<p>";

$css .= get ('layerSwitcher.css').PHP_EOL .PHP_EOL;
$css .= get ('myol.css');
file_put_contents ('myol.css', $css);
if (!$_GET)
	echo "TO myol.css</p>\n<p>";

$js .= get ('header.js').PHP_EOL .PHP_EOL;
$js .= get ('layerTileCollection.js').PHP_EOL .PHP_EOL;
$js .= get ('layerSwitcher.js').PHP_EOL .PHP_EOL;
$js .= get ('layerVector.js').PHP_EOL .PHP_EOL;
$js .= get ('layerVectorCollection.js').PHP_EOL .PHP_EOL;
$js .= get ('myol.js');
file_put_contents ('myol.js', $js);
if (!$_GET)
	echo 'TO myol.js</p>';

function get ($file) {
if (!$_GET)
		echo "$file, ";
	$text = file_get_contents ('src/'.$file);
	$texts = explode ('/*--*/', $text);

	return isset ($texts[1]) ? $texts[1] : $text;
}

/*
Automatic rebuild option
RewriteRule "assets/MyOl/myol.([a-z]+)" "assets/MyOl/build.php?$1" [QSA,L]
*/

if ($_GET) {
	$out = array_keys($_GET)[0];
	header ('Content-type: text/'.($out == 'css' ? 'css' : 'javascript'));
	echo $$out;
} else {
?>

	<h1 style="clear:both">MyOl</h1>
	<p>Set of js functions adding some facilities to <a href="https://openlayers.org/">Openlayers</a></p>
	<p>See doc & details on <a href="https://github.com/DC92/dev/tree/master/assets/MyOl">GITHUB</a></p>
	<p><a href="examples/layerSwitcher.html">Layer switcher</a></p>
	<p><a href="examples/layerTile.html">Layer tile</a></p>
	<p><a href="examples/layerVector.html">Layer vector</a></p>
	<p><a href="examples/controls.html">Controls</a></p>
	<p><a href="examples/marker.html">Marker</a></p>
	<p><a href="examples/editor.html">Editor</a></p>
	<p><a href="gps">Off line GPS</a></p>
	<p><a href="build.php">Build</a></p>
	<p><a href="https://github.com/Dominique92/MyOl/">GITHUB</a></p>

<?php } ?>